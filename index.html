<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Hydra Audio Visualizer</title>
  <script src="https://unpkg.com/hydra-synth@1.4.6"></script>
  <style>
    html, body {
      margin: 0; padding: 0; overflow: hidden; background: black; height: 100%;
      display: flex; justify-content: center; align-items: center;
    }
    canvas {
      width: 100vw;
      height: 100vh;
      display: block;
    }
  </style>
</head>
<body>
  
  <script>
    const hydra = new Hydra({
      detectAudio: true,
      canvas: document.createElement('canvas')
    });
    document.body.appendChild(hydra.canvas);

    const a = hydra.audio;

    if (a) {
      navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
        const audioCtx = new AudioContext();
        audioCtx.resume();
        const mic = audioCtx.createMediaStreamSource(stream);
        a.setSource(mic);
        a.show();

        osc(10, 0.03, 0.8)
          .color(
            () => 0.3 + a.fft[0] * 1.5,
            () => 0.4 + a.fft[2] * 1.2,
            () => 0.5 + a.fft[3] * 1.3
          )
          .rotate(() => time * 0.02 + a.fft[1] * 0.15)
          .modulate(
            osc(5, 0.02)
              .rotate(() => time * 0.1 + a.fft[2] * 0.5),
            0.3
          )
          .kaleid(6)
          .scale(() => 1 + a.fft[1] * 0.4)
          .add(
            shape(6, 0.3, 0.2)
              .scale(() => 0.8 + a.fft[0] * 0.5)
              .rotate(() => time * 0.05 + a.fft[3] * 0.2)
              .color(0.9, 0.6, 0.3)
              .mult(
                osc(20)
                  .rotate(0.5 + a.fft[1] * 0.3)
              )
              .modulate(noise(3).rotate(0.2), 0.15)
          )
          .blend(o0, 0.25)
          .out();

      }).catch(err => {
        console.error("Erreur acc√®s micro:", err);
      });
    } else {
      console.error("hydra.audio non disponible");
    }
  </script>

</body>
</html>
