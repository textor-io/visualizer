<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Hydra Audio Visualizer</title>
  <script defer src="https://unpkg.com/hydra-synth@1.3.0/dist/hydra-synth.min.js"></script>
  <script defer>
    window.onload = () => {
      const hydra = new Hydra({ detectAudio: false });

      navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
        const audioCtx = new AudioContext();
        const mic = audioCtx.createMediaStreamSource(stream);
        hydra.setAudioSource(mic);
      }).catch(e => console.error("Erreur accÃ¨s micro:", e));

      osc(10, 0.03, 0.8)
        .color(
          () => 0.3 + hydra.a.fft[0] * 1.5,
          () => 0.4 + hydra.a.fft[2] * 1.2,
          () => 0.5 + hydra.a.fft[3] * 1.3
        )
        .rotate(() => time * 0.02 + hydra.a.fft[1] * 0.15)
        .modulate(
          osc(5, 0.02).rotate(() => time * 0.1 + hydra.a.fft[2] * 0.5), 
          0.3
        )
        .kaleid(6)
        .scale(() => 1 + hydra.a.fft[1] * 0.4)
        .add(
          shape(6, 0.3, 0.2)
            .scale(() => 0.8 + hydra.a.fft[0] * 0.5)
            .rotate(() => time * 0.05 + hydra.a.fft[3] * 0.2)
            .color(0.9, 0.6, 0.3)
            .mult(
              osc(20).rotate(0.5 + hydra.a.fft[1] * 0.3)
            )
            .modulate(noise(3).rotate(0.2), 0.15)
        )
        .blend(o0, 0.25)
        .out();
    };
  </script>
  <style>
    body, html { margin: 0; height: 100%; overflow: hidden; background: black; }
    canvas { width: 100vw; height: 100vh; display: block; }
  </style>
</head>
<body>
</body>
</html>
